{"version":3,"sources":["component/Image/util/index.js","component/Image/index.js","page/home/component/card/index.js","page/home/component/filter/index.js","page/home/index.js"],"names":["checkSupportIO","name","window","Image","src","className","lazy","otherProps","useState","visible","setVisible","loading","setLoading","el","useRef","lazyLoadHandler","useEffect","observer","cb","console","warn","IntersectionObserver","entries","forEach","item","intersectionRatio","unobserve","observe","addLazyLoadListener","current","cls","cns","imgDom","onLoad","alt","ref","memo","Card","count","img","log","Filter","onClick","onChange","style","width","placeholder","marginLeft","Home","cardList","useSelector","state","home","filter","card","includes","dispatch","useDispatch","getCardList","useCallback","axios","get","then","res","code","setCardList","list","data","onClickChange","onChangeFilter","event","setFilter","target","value","length","map","image","color","slice","Array","fill","_","index","height"],"mappings":"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","file":"static/js/7.477cd042.chunk.js","sourcesContent":["const loadingImg =\n  \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMjhweCIgaGVpZ2h0PSIyMnB4IiB2aWV3Qm94PSIwIDAgMjggMjIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1LjIgKDc4MTgxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT5pbWFnZS1maWxs5aSH5Lu9PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9Iuafpeeci+WbvueJh+S8mOWMljQuMCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9IuWKoOi9veWbvueJhyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTU3Mi4wMDAwMDAsIC01MDYuMDAwMDAwKSI+CiAgICAgICAgICAgIDxnIGlkPSJpbWFnZS1maWxs5aSH5Lu9IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1NzAuMDAwMDAwLCA1MDEuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cmVjdCBpZD0iUmVjdGFuZ2xlIiBmaWxsPSIjMDAwMDAwIiBvcGFjaXR5PSIwIiB4PSIwIiB5PSIwIiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0yOSw1IEwzLDUgQzIuNDQ2ODc1LDUgMiw1LjQ0Njg3NSAyLDYgTDIsMjYgQzIsMjYuNTUzMTI1IDIuNDQ2ODc1LDI3IDMsMjcgTDI5LDI3IEMyOS41NTMxMjUsMjcgMzAsMjYuNTUzMTI1IDMwLDI2IEwzMCw2IEMzMCw1LjQ0Njg3NSAyOS41NTMxMjUsNSAyOSw1IFogTTEwLjU2MjUsOS41IEMxMS42NjU2MjUsOS41IDEyLjU2MjUsMTAuMzk2ODc1IDEyLjU2MjUsMTEuNSBDMTIuNTYyNSwxMi42MDMxMjUgMTEuNjY1NjI1LDEzLjUgMTAuNTYyNSwxMy41IEM5LjQ1OTM3NSwxMy41IDguNTYyNSwxMi42MDMxMjUgOC41NjI1LDExLjUgQzguNTYyNSwxMC4zOTY4NzUgOS40NTkzNzUsOS41IDEwLjU2MjUsOS41IFogTTI2LjYyMTg3NSwyMy4xNTkzNzUgQzI2LjU3ODEyNSwyMy4xOTY4NzUgMjYuNTE4NzUsMjMuMjE4NzUgMjYuNDU5Mzc1LDIzLjIxODc1IEw1LjUzNzUsMjMuMjE4NzUgQzUuNCwyMy4yMTg3NSA1LjI4NzUsMjMuMTA2MjUgNS4yODc1LDIyLjk2ODc1IEM1LjI4NzUsMjIuOTA5Mzc1IDUuMzA5Mzc1LDIyLjg1MzEyNSA1LjM0Njg3NSwyMi44MDYyNSBMMTAuNjY4NzUsMTYuNDkzNzUgQzEwLjc1NjI1LDE2LjM4NzUgMTAuOTE1NjI1LDE2LjM3NSAxMS4wMjE4NzUsMTYuNDYyNSBDMTEuMDMxMjUsMTYuNDcxODc1IDExLjA0Mzc1LDE2LjQ4MTI1IDExLjA1MzEyNSwxNi40OTM3NSBMMTQuMTU5Mzc1LDIwLjE4MTI1IEwxOS4xLDE0LjMyMTg3NSBDMTkuMTg3NSwxNC4yMTU2MjUgMTkuMzQ2ODc1LDE0LjIwMzEyNSAxOS40NTMxMjUsMTQuMjkwNjI1IEMxOS40NjI1LDE0LjMgMTkuNDc1LDE0LjMwOTM3NSAxOS40ODQzNzUsMTQuMzIxODc1IEwyNi42NTkzNzUsMjIuODA5Mzc1IEMyNi43NDA2MjUsMjIuOTEyNSAyNi43MjgxMjUsMjMuMDcxODc1IDI2LjYyMTg3NSwyMy4xNTkzNzUgWiIgaWQ9IlNoYXBlIiBmaWxsPSIjRThFOEU4Ij48L3BhdGg+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==\";\n\nfunction checkSupportIO() {\n  const name = \"IntersectionObserver\";\n  return name in window && `${name}Entry` in window;\n}\n\nfunction addLazyLoadListener(el, cb = () => {}) {\n  if (!checkSupportIO()) { // 考虑兼容性可以参考: https://github.com/w3c/IntersectionObserver/blob/main/polyfill/README.md\n    cb();\n    return console.warn(\"该环境不支持 IntersectionObserver，图片懒加载功能失效。\");\n  }\n  const observer = new IntersectionObserver((entries) => {\n    entries.forEach((item) => {\n      if (item.intersectionRatio <= 0) {\n        return;\n      }\n      cb();\n      observer.unobserve(el);\n    });\n  });\n  observer.observe(el);\n  return observer;\n}\n\nexport { loadingImg, addLazyLoadListener };\n","import PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport { useState, useEffect, memo, useRef } from \"react\";\nimport cns from \"classnames\";\nimport { loadingImg, addLazyLoadListener } from \"./util/index\";\n\nfunction Image({ src, className, lazy, ...otherProps }) {\n  const [visible, setVisible] = useState(!lazy); // 图片是否可见 \n  const [loading, setLoading] = useState(true); // 图片是否在加载 \n  const el = useRef(null);\n\n  function lazyLoadHandler() {\n    setVisible(true);\n  }\n  useEffect(() => {\n    let observer;\n    if (lazy) {\n      observer = addLazyLoadListener(el.current, lazyLoadHandler);\n    }\n    return () => {\n      if (observer && el.current) {\n        observer.unobserve(el.current);\n      }\n    };\n  }, [lazy]);\n  function onLoad() {\n    setLoading(false);\n  }\n  const cls = cns(className, \"image__real\", {\n    \"image__real--hidden\": loading,\n  });\n  const imgDom = <img src={src} onLoad={onLoad} className={cls} alt=\"img\" {...otherProps} />;\n  return (\n    <div ref={el}>\n      {visible && imgDom}\n      {loading && <img src={loadingImg} alt=\"loading img\" className={className} {...otherProps} />}\n    </div>\n  );\n}\n\nImage.propTypes = {\n  src: PropTypes.string,\n  lazy: PropTypes.bool,\n  className: PropTypes.string,\n};\n\nexport default memo(Image);\n","import { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport Image from \"@/component/Image\";\n\nfunction Card({ name, count, img }) {\n  console.log(\"render card\");\n  return (\n    <div className=\"card\">\n      <div className=\"card__name\">{name}</div>\n      <div className=\"card__count\">{count}</div>\n      <Image className=\"card__img\" src={img} lazy />\n    </div>\n  );\n}\n\nCard.propTypes = {\n  name: PropTypes.string,\n  count: PropTypes.number,\n  img: PropTypes.string,\n};\n\nexport default memo(Card);\n","import { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport { Button, Input } from \"antd\";\n\nfunction Filter({ onClick, onChange }) {\n  console.log(\"render filter\");\n  return (\n    <div className=\"filter\">\n      <Input style={{ width: 400 }} onChange={onChange} placeholder=\"请输入过滤选项\" />\n      <Button style={{ marginLeft: 8 }} onClick={onClick}>\n        换一批\n      </Button>\n    </div>\n  );\n}\n\nFilter.propTypes = {\n  onClick: PropTypes.func,\n  onChange: PropTypes.func,\n};\n\nexport default memo(Filter);\n","import { useEffect, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport axios from \"@/util/http\";\nimport { setCardList, setFilter } from \"./meta/homeReducer\";\nimport Card from \"./component/card\";\nimport Filter from \"./component/filter\";\nimport { Badge } from \"antd\";\nimport \"./index.scss\";\n\nexport default function Home() {\n  console.log(\"render home\");\n  const cardList = useSelector((state) => {\n    return state.home.cardList.filter((card) => {\n      const str = \"\" + card.name + card.count;\n      return str.includes(state.home.filter);\n    });\n  });\n  const dispatch = useDispatch();\n  const getCardList = useCallback(() => {\n    axios.get(\"/getCardList\").then((res) => {\n      if (res?.code !== 0) {\n        return;\n      }\n      dispatch(setCardList({ list: res?.data }));\n    });\n  }, [dispatch]);\n\n  useEffect(getCardList, [getCardList]);\n\n  const onClickChange = useCallback(() => {\n    getCardList();\n  }, [getCardList]);\n\n  const onChangeFilter = useCallback(\n    (event) => {\n      dispatch(setFilter({ filter: event.target.value }));\n    },\n    [dispatch]\n  );\n\n  return (\n    <div className=\"home\">\n      <div className=\"home__filter\">\n        <Filter onClick={onClickChange} onChange={onChangeFilter} />\n      </div>\n      <div className=\"home__card\">\n        <Badge count={cardList.length} className=\"home__card__badge\" />\n        {cardList.map((card) => {\n          // card.image 追加 query，是为了测试图片的 懒加载功能\n          return <Card key={card.name + card.count} name={card.name} count={card.count} img={card.image + \"/\" + card.color.slice(1)} />;\n        })}\n        {\n          // 首/末 行对齐，补齐数量大于屏幕显示最大数量即可\n          Array(10)\n            .fill(true)\n            .map((_, index) => (\n              <div key={index} style={{ width: \"316px\", height: 0 }} />\n            ))\n        }\n      </div>\n    </div>\n  );\n}\n"],"sourceRoot":""}