{"version":3,"sources":["component/Image/index.js","component/Image/util/index.js","component/hoc/withAppear.js","util/track/index.js","page/home/component/card/index.js","page/home/component/filter/index.js","page/home/component/track/index.js","component/infinite-scroll/util/index.js","component/infinite-scroll/index.js","page/home/index.js","page/home/meta/selector.js"],"names":["Image","src","className","lazy","onLoad","width","height","otherProps","useState","visible","setVisible","loading","setLoading","el","useRef","lazyLoadHandler","useEffect","observer","cb","checkSupportIO","console","warn","IntersectionObserver","entries","forEach","item","intersectionRatio","unobserve","observe","addLazyLoadListener","current","cls","cns","imgDom","style","alt","ref","hash","defaultProps","memo","withAppear","type","Wrapped","children","onAppear","onDisappear","firstAppear","firstDisappear","props","dom","addEventListener","setAttribute","removeEventListener","createElement","displayName","propTypes","PropTypes","node","func","bool","Div","instance","this","subscribers","list","f","push","index","findIndex","_","splice","data","trigger","time","Date","now","msg","Card","url","creator","labels","eventData","log","loaded","setLoaded","bind","Ribbon","text","color","title","slice","onClick","download","viewBox","version","d","map","label","Filter","onChange","placeholder","marginLeft","Track","setList","subscribe","useTrackData","listRef","scrollTo","top","scrollHeight","behavior","CloseCircleFilled","mode","Item","formatDateTime","icon","BarChartOutlined","val","hasScrolled","InfiniteScroll","loadMore","loadMoreRef","containerRef","removeScrollListener","scroll","addScrollListenter","addLoadMoreListener","Home","cardList","useSelector","useMemo","createSelector","state","home","filter","card","join","includes","dispatch","useDispatch","getCardList","onChangeFilter","useCallback","event","setFilter","target","value","append","Array","fill","length"],"mappings":"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","file":"static/js/7.0324b24c.chunk.js","sourcesContent":["import PropTypes from \"prop-types\";\nimport cns from \"classnames\";\nimport { Blurhash } from \"react-blurhash\";\nimport { useState, useEffect, memo, useRef } from \"react\";\nimport { addLazyLoadListener } from \"./util/index\";\nimport \"./index.scss\";\n\nfunction Image({ src, className, lazy, onLoad, width, height, ...otherProps }) {\n  const [visible, setVisible] = useState(!lazy); // 图片是否可见\n  const [loading, setLoading] = useState(true); // 图片是否在加载\n  const el = useRef(null);\n\n  function lazyLoadHandler() {\n    setVisible(true);\n  }\n  useEffect(() => {\n    let observer;\n    if (lazy) {\n      observer = addLazyLoadListener(el.current, lazyLoadHandler);\n    }\n    return () => {\n      if (observer && el.current) {\n        observer.unobserve(el.current);\n      }\n    };\n  }, [lazy]);\n  function _onLoad() {\n    setLoading(false);\n    onLoad();\n  }\n  const cls = cns(className, \"image__real\", {\n    \"image__real--hidden\": loading,\n  });\n  const imgDom = <img src={src} style={{ width, height }} onLoad={_onLoad} className={cls} alt=\"img\" {...otherProps} />;\n  return (\n    <div ref={el} className=\"image\">\n      {visible && imgDom}\n      {loading && <Blurhash hash=\"LEHV6nWB2yk8pyo0adR*.7kCMdnj\" width={width} height={height} />}\n    </div>\n  );\n}\n\nImage.propTypes = {\n  src: PropTypes.string,\n  lazy: PropTypes.bool,\n  className: PropTypes.string,\n  onLoad: PropTypes.func,\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n};\n\nImage.defaultProps = {\n  onLoad: () => {},\n};\n\nexport default memo(Image);\n","import { checkSupportIO } from \"@/util\";\n\nfunction addLazyLoadListener(el, cb = () => {}) {\n  if (!checkSupportIO()) {\n    cb();\n    return console.warn(\"该环境不支持 IntersectionObserver，图片懒加载功能失效。\");\n  }\n  const observer = new IntersectionObserver((entries) => {\n    entries.forEach((item) => {\n      if (item.intersectionRatio <= 0) {\n        return;\n      }\n      cb();\n      observer.unobserve(el);\n    });\n  });\n  observer.observe(el);\n  return observer;\n}\n\nexport { addLazyLoadListener };\n","import { createElement, useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\n\nfunction withAppear(type) {\n  const Wrapped = ({ children, onAppear, onDisappear, firstAppear, firstDisappear, ...props }) => {\n    const ref = useRef(null);\n    useEffect(() => {\n      const dom = ref.current;\n      dom.addEventListener(\"appear\", onAppear);\n      dom.addEventListener(\"disappear\", onDisappear);\n      dom.setAttribute(\"data-appear-once\", firstAppear);\n      dom.setAttribute(\"data-disappear-once\", firstDisappear);\n      return () => {\n        dom.removeEventListener(\"appear\", onAppear);\n        dom.removeEventListener(\"disappear\", onDisappear);\n      };\n    }, []);\n    return createElement(type, { ...props, ref }, children);\n  };\n  Wrapped.displayName = `appear_${type}`;\n  Wrapped.propTypes = {\n    children: PropTypes.node,\n    onAppear: PropTypes.func,\n    onDisappear: PropTypes.func,\n    firstAppear: PropTypes.bool,\n    firstDisappear: PropTypes.bool,\n  };\n  Wrapped.defaultProps = {\n    onAppear: () => {},\n    onDisappear: () => {},\n    firstAppear: false,\n    firstDisappear: false,\n  };\n  return Wrapped;\n}\n\nexport default withAppear;\n\nexport const Div = withAppear(\"div\");\n","import { useState, useEffect } from \"react\";\nclass Trigger {\n  constructor() {\n    this.subscribers = [];\n    this.list = [];\n  }\n\n  subscribe(f) {\n    this.subscribers.push(f);\n  }\n\n  unsubscribe(f) {\n    const index = this.subscribers.findIndex((_) => _ === f);\n    if (index >= 0) {\n      this.subscribers.splice(index, 1);\n    }\n  }\n\n  trigger() {\n    this.subscribers.forEach((_) => _(this.list));\n  }\n\n  push(data) {\n    this.list = [...this.list, data];\n    this.trigger();\n  }\n}\n\nconst instance = new Trigger();\n\nexport function useTrackData() {\n  const [list, setList] = useState([]);\n  useEffect(() => {\n    instance.subscribe(setList);\n  }, []);\n  return {\n    list,\n  };\n}\n\nexport function onAppear(data) {\n  instance.push({\n    time: Date.now(),\n    msg: `索引(${data.index}) 出现了`,\n  });\n}\n\nexport function onDisappear() {\n  // do nothing\n}\n","/* eslint-disable no-unused-vars */\nimport { memo, useState } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport Image from \"@/component/Image\";\nimport { download } from \"@/util\";\nimport { Div } from \"@/component/hoc/withAppear\";\nimport { onAppear, onDisappear } from \"@/util/track\";\nimport { Badge } from \"antd\";\n\nfunction Card({ url, creator, labels, eventData }) {\n  console.log(\"render card\");\n  const [loaded, setLoaded] = useState(false);\n  function onLoad() {\n    setLoaded(true);\n  }\n\n  return (\n    <Div\n      className=\"card\"\n      onAppear={onAppear.bind(null, eventData)}\n      onDisappear={onDisappear.bind(null, eventData)}\n    >\n      <Badge.Ribbon text={eventData.index} color=\"magenta\">\n        <div className=\"card__top\">\n          <Image src={url} onLoad={onLoad} width={300} height={300} lazy />\n          {loaded && (\n            <div className=\"card__mask\">\n              <div className=\"card__creator\" title={creator}>\n                {creator.slice(0, 1)}\n              </div>\n              <div className=\"card__download\" onClick={() => download(url)}>\n                <svg\n                  width=\"32\"\n                  height=\"32\"\n                  className=\"c_c7b\"\n                  viewBox=\"0 0 32 32\"\n                  version=\"1.1\"\n                  aria-hidden=\"false\"\n                >\n                  <path d=\"M25.8 15.5l-7.8 7.2v-20.7h-4v20.7l-7.8-7.2-2.7 3 12.5 11.4 12.5-11.4z\"></path>\n                </svg>\n              </div>\n            </div>\n          )}\n        </div>\n      </Badge.Ribbon>\n      <div className=\"card__labels\">\n        {labels.map((label) => {\n          return (\n            <span key={label} className=\"card__labels__item\">\n              {label}\n            </span>\n          );\n        })}\n      </div>\n    </Div>\n  );\n}\n\nCard.propTypes = {\n  url: PropTypes.string,\n  creator: PropTypes.string,\n  labels: PropTypes.array,\n  eventData: PropTypes.object,\n};\n\nexport default memo(Card);\n","import { memo } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport { Button, Input } from \"antd\";\n\nfunction Filter({ onClick, onChange }) {\n  console.log(\"render filter\");\n  return (\n    <div className=\"filter\">\n      <Input style={{ width: 400 }} onChange={onChange} placeholder=\"请输入过滤选项\" />\n      <Button style={{ marginLeft: 8 }} onClick={onClick}>\n        换一批\n      </Button>\n    </div>\n  );\n}\n\nFilter.propTypes = {\n  onClick: PropTypes.func,\n  onChange: PropTypes.func,\n};\n\nexport default memo(Filter);\n","import { Tag, Timeline } from \"antd\";\nimport { memo, useRef, useState, useEffect } from \"react\";\nimport { BarChartOutlined, CloseCircleFilled } from \"@ant-design/icons\";\nimport { useTrackData } from \"@/util/track\";\nimport { formatDateTime } from \"@/util\";\nimport cns from \"classnames\";\nimport \"./index.scss\";\n\nfunction Track() {\n  const [visible, setVisible] = useState(false);\n  const { list } = useTrackData();\n  const listRef = useRef(null);\n  useEffect(() => {\n    listRef.current.scrollTo({\n      top: listRef.current.scrollHeight,\n      behavior: \"smooth\",\n    });\n  }, [list]);\n  const cls = cns(\"track__content\", {\n    \"track__content--visible\": visible,\n    \"track__content--hidden\": !visible,\n  });\n  return (\n    <div className=\"track\">\n      <div className={cls} ref={listRef}>\n        <CloseCircleFilled\n          className=\"track__close\"\n          onClick={() => {\n            setVisible(false);\n          }}\n        />\n        <div>\n          <Timeline mode={\"left\"}>\n            {list.map((item, index) => {\n              return (\n                <Timeline.Item\n                  key={index}\n                  label={formatDateTime(item.time)}\n                  className=\"track__content__item\"\n                >\n                  {item.msg}\n                </Timeline.Item>\n              );\n            })}\n          </Timeline>\n        </div>\n      </div>\n      <Tag\n        icon={<BarChartOutlined />}\n        color=\"processing\"\n        className=\"track__btn\"\n        onClick={() => {\n          setVisible((val) => {\n            return !val;\n          });\n        }}\n      >\n        埋点\n      </Tag>\n    </div>\n  );\n}\n\nexport default memo(Track);\n","let hasScrolled = false;\n\nexport function addLoadMoreListener(el, cb = () => {}) {\n  const observer = new IntersectionObserver((entries) => {\n    entries.forEach((item) => {\n      if (item.intersectionRatio <= 0 || !hasScrolled) {\n        return;\n      }\n      cb();\n    });\n  });\n  observer.observe(el);\n  return {\n    unobserve: () => {\n      observer.unobserve(el);\n    },\n  };\n}\n\nexport function addScrollListenter(el) {\n  function scroll() {\n    hasScrolled = true;\n  }\n  el.addEventListener(\"scroll\", scroll);\n  return {\n    removeScrollListener: () => {\n      hasScrolled = false;\n      el.removeEventListener(\"scroll\", scroll);\n    },\n  };\n}\n","import { useEffect, useRef } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"./index.scss\";\nimport { addLoadMoreListener, addScrollListenter } from \"./util\";\n\nexport default function InfiniteScroll({ loadMore, children }) {\n  const loadMoreRef = useRef(null);\n  const containerRef = useRef(null);\n  useEffect(() => {\n    const { removeScrollListener } = addScrollListenter(containerRef.current);\n    const { unobserve } = addLoadMoreListener(loadMoreRef.current, loadMore);\n    return () => {\n      removeScrollListener();\n      unobserve();\n    };\n  }, []);\n  return (\n    <div ref={containerRef} className=\"infinite-scroll\">\n      <div className=\"infinite-scroll__content\">\n        {children}\n      </div>\n      <div ref={loadMoreRef} className=\"infinite-scroll__load-more\" />\n    </div>\n  );\n}\n\nInfiniteScroll.propTypes = {\n  loadMore: PropTypes.func,\n  children: PropTypes.node,\n};\n\nInfiniteScroll.defaultProps = {\n  loadMore: () => {},\n};\n","import { useEffect, useCallback } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getCardList, setFilter } from \"./meta/homeReducer\";\nimport Card from \"./component/card\";\nimport Filter from \"./component/filter\";\nimport Track from \"./component/track\";\nimport { makeSelectCardList } from \"./meta/selector\";\nimport InfiniteScroll from \"@/component/infinite-scroll\";\nimport \"./index.scss\";\n\nexport default function Home() {\n  console.log(\"render home\");\n  const cardList = useSelector(makeSelectCardList());\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch(getCardList());\n  }, [getCardList]);\n\n  function onClickChange() {\n    dispatch(getCardList());\n  }\n\n  const onChangeFilter = useCallback(\n    (event) => {\n      dispatch(setFilter({ filter: event.target.value }));\n    },\n    [dispatch]\n  );\n\n  function loadMore() {\n    dispatch(getCardList({ append: true }));\n  }\n\n  return (\n    <div className=\"home\">\n      <div className=\"home__filter\">\n        <Filter onClick={onClickChange} onChange={onChangeFilter} />\n      </div>\n      <div className=\"home__card\">\n        <InfiniteScroll loadMore={loadMore} onAppear={() => {}}>\n          <div className=\"home__card__list\">\n            {cardList.map((card, index) => {\n              return <Card key={card.url} creator={card.creator} url={card.url} labels={card.labels} eventData={{ url: card.url, index }} />;\n            })}\n            {\n              // 首/末 行对齐，补齐数量大于屏幕显示最大数量即可\n              Array(10)\n                .fill(true)\n                .map((_, index) => (\n                  <div key={index} style={{ width: \"316px\", height: 0 }} />\n                ))\n            }\n          </div>\n          {cardList.length > 0 && <div className=\"home__card__loading\">loading...</div>}\n        </InfiniteScroll>\n      </div>\n      <Track />\n    </div>\n  );\n}\n","import { useMemo } from \"react\";\nimport { createSelector } from \"reselect\";\n\nexport const makeSelectCardList = function () {\n  return useMemo(\n    () =>\n      createSelector(\n        (state) => state.home.cardList,\n        (state) => state.home.filter,\n        (cardList, filter) => {\n          return cardList.filter((card) => {\n            const str = card.labels.join(\"\");\n            return str.includes(filter);\n          });\n        }\n      ),\n    []\n  );\n};\n"],"sourceRoot":""}